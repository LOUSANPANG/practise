## 约束

```bash
# 语法
NOT NULL # 限制该字段的数据不能为null
UNIQUE # 限制该字段的数据不能重复
PRIMARY KEY # 主键，唯一标识，不能为null，不能重复
DEFAULT # 默认值，当插入数据时未指定该字段的值，则使用默认值
CHECK # 检查约束，限制字段值的范围
FOREIGN KEY # 外键，用于关联其他表的主键

# 建表和修改表 针对字段添加约束
# 建表时添加约束
CREATE TABLE 表名(
  字段名 数据类型 约束,
  字段名 数据类型 约束,
  字段名 数据类型 约束
);

# 修改表时添加约束
ALTER TABLE 表名 ADD 约束;
# 修改表时添加约束
ALTER TABLE 表名 MODIFY 字段名 数据类型 约束;
# 删除表时添加约束
ALTER TABLE 表名 DROP 约束;
# 建立外键关联
ALTER TABLE 表名 ADD CONSTRAINT 外键名 FOREIGN KEY (字段名) REFERENCES 其他表名(主键字段名);
# 删除外键关联
ALTER TABLE 表名 DROP FOREIGN KEY 外键名;


# 举例
CREATE TABLE user (
  id INT PRIMARY KEY AUTO_INCREMENT comment '主键',
  name VARCHAR(20) NOT NULL UNIQUE comment '姓名',
  age INT CHECK (age > 0) comment '年龄',
  sex ENUM('男', '女') DEFAULT '男' comment '性别'
) comment '用户表';
insert into user (name, age, sex) values ('张三', 18, '男');
```


### 外键关联

```bash
# 外键约束，删除/更新行为

ON DELETE # 外键关联的表的删除行为
ON UPDATE # 外键关联的表的更新行为

NO ACTION # 当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新
RESTRICT # 当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则不允许删除/更新
CASCADE # 当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则也删除/更新外键记录
SET NULL # 当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则设置外键值为null
SET DEFAULT # 当在父表中删除/更新对应记录时，首先检查该记录是否有对应外键，如果有则设置外键值为默认值


# 外键关联的表的操作
# 级联更新，当关联的表的主键值更新时，外键关联的表的字段值也会更新
ALTER TABLE 表名 ADD CONSTRAINT 外键名 FOREIGN KEY (字段名) REFERENCES 其他表名(主键字段名) ON UPDATE CASCADE;
# 级联删除，当关联的表的主键值删除时，外键关联的表的字段值设置为null
ALTER TABLE 表名 ADD CONSTRAINT 外键名 FOREIGN KEY (字段名) REFERENCES 其他表名(主键字段名) ON DELETE SET NULL;
```
