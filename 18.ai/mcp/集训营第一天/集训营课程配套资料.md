# é›†è®­è¥

>20:30 å‡†æ—¶å¼€å§‹

å‰ç«¯è¦è¢« AI å–ä»£äº† ï¼Ÿ

å‰ç«¯å’Œ AI æ˜¯å…±ç”Ÿçš„å…³ç³»

1. AI å…¬å¸ï¼Œä¼šç»™å‰ç«¯å¸¦æ¥æ–°çš„å²—ä½ï¼Œæ™®é€šç”¨æˆ·å’Œ AI äº¤äº’çš„ä¸»æµæ–¹å¼å°±æ˜¯ Web åº”ç”¨
2. AI æ˜¯ç»™å‰ç«¯èµ‹èƒ½çš„
   - AI ç›¸å…³çš„ç»éªŒä¼šæˆä¸ºä½ ç®€å†çš„éš¾ç‚¹äº®ç‚¹



```
å¤§æ¨¡å‹ --> Agent --> Function Calling --> MCP
```

é¢å‘é›¶åŸºç¡€å­¦å‘˜

>**å®‰å…¨ä¾èµ–å®¡è®¡å·¥å…·ï¼ˆSecurity-Checkï¼‰ï½œMCP Server / Node.js / LLM å·¥å…·é“¾**
>
>æ„å»ºåŸºäº MCP åè®®çš„ä¾èµ–æ¼æ´å®¡è®¡æœåŠ¡ï¼Œæ”¯æŒè§£æé¡¹ç›®ä¾èµ–é¡¹å¹¶è‡ªåŠ¨æ£€æµ‹ CVEã€CVSS ç­‰å®‰å…¨é£é™©ï¼Œè¿”å›ç»“æ„åŒ–å®¡è®¡æŠ¥å‘Šã€‚å·¥å…·åŒæ—¶é€‚é…æœ¬åœ°å¼€å‘ç¯å¢ƒä¸äº‘ç«¯æ™ºèƒ½ä½“å¹³å°ï¼Œå¯ä½œä¸º LLM å·¥å…·é“¾ä¸­çš„å®‰å…¨èƒ½åŠ›æ¨¡å—çµæ´»å¤ç”¨ã€‚
>
>è¯¥æœåŠ¡åŸºäº npm å®˜æ–¹ Registry å®¡è®¡ APIï¼Œæ”¯æŒè§£æ `dependencies` ä¸ `devDependencies` å­—æ®µï¼Œæ˜ å°„ GitHub Advisoryã€CVSS ç­‰æ¼æ´æºã€‚æ”¯æŒå¤šç§è°ƒç”¨æ–¹å¼ï¼šä¼ å…¥ä¾èµ–åˆ—è¡¨ã€è§£æå®Œæ•´ `package.json`ã€é€šè¿‡è·¯å¾„è¯»å–ä¾èµ–ï¼Œ**å¯ä¸æ–‡ä»¶ç³»ç»Ÿç±»å·¥å…·ç»„åˆå½¢æˆè‡ªåŠ¨å®¡è®¡é“¾è·¯**ã€‚
>
>å·¥å…·å·²é›†æˆè‡³ Cursor ç¼–è¾‘å™¨ï¼Œä½œä¸º AI ç¼–ç å·¥å…·é“¾ä¸­çš„æ ¸å¿ƒå®‰å…¨æ’ä»¶ï¼›ä¹Ÿå¯ä½œä¸º LangChain.jsã€Dify ç­‰å¹³å°ä¸‹æ™ºèƒ½ä½“ç»Ÿä¸€è°ƒåº¦çš„å·¥å…·æ¨¡å—æ¥å…¥ã€‚
>
>å•æ¬¡è°ƒç”¨å»¶è¿Ÿä½äº 200msï¼Œæ¼æ´è¯†åˆ«å‡†ç¡®ç‡è¾¾ 95%+ï¼Œå®¡è®¡ç»“æœç»“æ„åŒ–ï¼Œå¯ä¾›æ™ºèƒ½ä½“è¿›ä¸€æ­¥æ¨ç†å¤„ç†ã€‚é¡¹ç›®è½åœ°åå·²åœ¨ 20+ å†…éƒ¨é¡¹ç›®ä¸­å®é™…ä½¿ç”¨ï¼Œè¾…åŠ©è¯†åˆ«ä¾èµ–æ¼æ´è¿‘ 50 é¡¹ï¼Œ**äººå·¥ä»‹å…¥æ—¶é—´ä»çº¦ 20 åˆ†é’Ÿç¼©çŸ­è‡³ 2 åˆ†é’Ÿï¼Œæ•ˆç‡æå‡è¾¾ 90%+**ã€‚



## å¤§æ¨¡å‹

å¤§æ¨¡å‹ï¼Œå…¨ç§°â€œå¤§è¯­è¨€æ¨¡å‹â€ï¼Œè‹±è¯­ Large Language Modelï¼Œç®€ç§° LLM.

ğŸ™‹ LLM æ˜¯å¦ç­‰ä»·äº AI ï¼Ÿ

> å›ç­”ï¼šä¸ç­‰äº
>
> AIï¼šæ‰€æœ‰æ¨¡ä»¿äººç±»è¡Œä¸ºçš„ç®—æ³•ã€æ¨¡å‹ã€ç³»ç»Ÿéƒ½å±äº AI çš„èŒƒç•´
>
> - æœºå™¨äºº
> - è®¡ç®—æœºè§†è§‰
> - è‡ªåŠ¨é©¾é©¶
> - è¯­éŸ³è¯†åˆ«
> - è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLP é‡Œé¢çš„ä¸€ç§å®ç°æ–¹å¼ï¼‰
> - ....

å‰æœŸå°† LLM çœ‹ä½œæ˜¯ä¸€ä¸ªé»‘ç›’ã€‚ğŸ¤”å¦‚ä½•å’Œè¿™ä¸ªé»‘ç›’è¿›è¡Œäº¤äº’ï¼Ÿ

**è¾“å…¥** --> **è¾“å‡º**

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-04-231458.png" alt="image-20250705071457641" style="zoom:50%;" />

å¤§è¯­è¨€æ¨¡å‹æœ‰å¾ˆå¤šï¼š

1. Llamaï¼ˆMetaï¼‰
2. qwenï¼ˆé˜¿é‡Œçš„åƒé—®ï¼‰
3. deepseekï¼ˆæ·±åº¦æ±‚ç´¢ï¼‰
4. .....

åŸºäºTransformeræ¶æ„

æˆ‘ä»¬éœ€è¦çŸ¥é“å¤§è¯­è¨€æ¨¡å‹å·¥ä½œçš„æœ¬è´¨å°±æ˜¯ **è¾“å…¥** å’Œ **è¾“å‡º**ã€‚



**å¤§æ¨¡å‹çš„ä½¿ç”¨**

1. å®˜æ–¹æä¾›çš„åº”ç”¨
   - ChatGPTï¼šWebåº”ç”¨ã€GPT æ˜¯æ¨¡å‹
   - åŠŸèƒ½å›ºå®š
2. è¿œç¨‹ API è°ƒç”¨å¤§æ¨¡å‹
   - ç®—åŠ›å¼º
   - æ”¶è´¹
   - éšç§å®‰å…¨é—®é¢˜
3. æœ¬åœ°éƒ¨ç½²ï¼šåªèƒ½éƒ¨ç½²å¼€æºçš„æ¨¡å‹
   - Ollamaï¼ˆMetaï¼‰

æœ¬æ¬¡é›†è®­è¥é€‰æ‹©è¿œç¨‹ API è°ƒç”¨å¤§æ¨¡å‹çš„å½¢å¼ï¼Œæ¨¡å‹é€‰æ‹© deepseek.

[deepseek å¼€å‘å¹³å°](https://platform.deepseek.com/) ç”³è¯·ä¸€ä¸ª api key

åˆ›å»º api key çš„æ—¶å€™è¦ä¿å­˜ä¸‹æ¥ï¼Œä¸ç„¶ä¹‹åå°±çœ‹ä¸åˆ°äº†



ç”¨ `curl` å‘½ä»¤å’Œå¤§æ¨¡å‹è¿›è¡Œäº¤äº’ï¼š

```bash
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-73d4caa5bc8149fa8ef17c76463a1003" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "user", "content": "ä½ æ˜¯è°ï¼Ÿ"}
        ],
        "stream": true
      }'
```

è¿”å›çš„å†…å®¹å¦‚ä¸‹ï¼š

```json
{
  "id": "81dddbb5-c01b-476b-a5d5-c5ac87e31b92", // æ¯æ¬¡è¯·æ±‚çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUIDï¼‰
  "object": "chat.completion",                 // è¿”å›å¯¹è±¡ç±»å‹ï¼Œè¿™é‡Œè¡¨ç¤ºæ˜¯èŠå¤©è¡¥å…¨ç»“æœ
  "created": 1751766353,                       // å“åº”ç”Ÿæˆæ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼Œå•ä½ç§’ï¼‰
  "model": "deepseek-chat",                    // ä½¿ç”¨çš„æ¨¡å‹åç§°

  "choices": [                                 // æ¨¡å‹è¿”å›çš„ä¸€ä¸ªæˆ–å¤šä¸ªå›ç­”ï¼ˆé€šå¸¸åªä¼šæœ‰ä¸€ä¸ªï¼‰
    {
      "index": 0,                              // å½“å‰å›ç­”çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
      "message": {
        "role": "assistant",                   // æ¶ˆæ¯è§’è‰²ï¼Œè¿™é‡Œæ˜¯ AI åŠ©æ‰‹
        "content": "æˆ‘æ˜¯ä¸€ä¸ªæ™ºèƒ½AIåŠ©æ‰‹ï¼Œéšæ—¶ä¸ºä½ æä¾›å¸®åŠ©å’Œè§£ç­”é—®é¢˜ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ" // æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬å†…å®¹
      },
      "logprobs": null,                        // token æ¦‚ç‡ä¿¡æ¯ï¼ˆå¦‚æœªå¯ç”¨ logprobs åˆ™ä¸º nullï¼‰
      "finish_reason": "stop"                  // ç»“æŸåŸå› ï¼šstop è¡¨ç¤ºæ­£å¸¸ç”Ÿæˆç»“æŸ
    }
  ],

  "usage": {                                   // æœ¬æ¬¡è¯·æ±‚çš„ Token ä½¿ç”¨æƒ…å†µ
    "prompt_tokens": 25,                       // ç”¨æˆ·è¾“å…¥å ç”¨çš„ token æ•°
    "completion_tokens": 19,                   // æ¨¡å‹å›å¤å ç”¨çš„ token æ•°
    "total_tokens": 44,                        // æ€»å…±ä½¿ç”¨çš„ token æ•°
    "prompt_tokens_details": {
      "cached_tokens": 0                       // å‘½ä¸­ç¼“å­˜çš„ token æ•°ï¼ˆå¦‚å¯ç”¨ prompt ç¼“å­˜æœºåˆ¶ï¼‰
    },
    "prompt_cache_hit_tokens": 0,              // ç¼“å­˜å‘½ä¸­ token æ•°ï¼ˆæœ¬æ¬¡ä¸º 0ï¼Œè¡¨ç¤ºæœªå‘½ä¸­ï¼‰
    "prompt_cache_miss_tokens": 25             // ç¼“å­˜æœªå‘½ä¸­ token æ•°ï¼ˆæœ¬æ¬¡ä¸º 25ï¼Œå³å…¨éƒ¨æœªå‘½ä¸­ï¼‰
  },

  "system_fingerprint": "fp_8802369eaa_prod0623_fp8_kvcache" // ç³»ç»Ÿ/æ¨¡å‹è¿è¡Œç¯å¢ƒæŒ‡çº¹ï¼Œç”¨äºè¿½è¸ªæ¨¡å‹ç‰ˆæœ¬ç­‰
}
```

ç›®å‰çš„å¤§æ¨¡å‹ä»…ä»…æ˜¯ç®€å•çš„ **è¾“å…¥** å’Œ **è¾“å‡º**ï¼Œç”šè‡³è¿ä¸Šä¸‹æ–‡éƒ½ä¸æ”¯æŒã€‚

```bash
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-73d4caa5bc8149fa8ef17c76463a1003" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "user", "content": "ä½ æ˜¯è°ï¼Ÿ"}
        ],
        "stream": false
      }'
```

```bash
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-73d4caa5bc8149fa8ef17c76463a1003" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "user", "content": "æˆ‘åˆšæ‰è¯´çš„å•¥ï¼Ÿ"}
        ],
        "stream": false
      }'
```



ğŸ™‹é‚£æœ‰æ²¡æœ‰åŠæ³•è®©æ¨¡å‹æ”¯æŒä¸Šä¸‹æ–‡å‘¢ï¼Ÿ

åªéœ€è¦å°†ä¹‹å‰çš„ä¼šè¯åŠ å…¥åˆ° messages æ•°ç»„é‡Œé¢å°±å¯ä»¥äº†ã€‚

```bash
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-73d4caa5bc8149fa8ef17c76463a1003" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "user", "content": "ä½ æ˜¯è°ï¼Ÿ"},
          {"role": "system", "content": "æˆ‘æ˜¯ä¸€ä¸ªæ™ºèƒ½AIåŠ©æ‰‹ï¼Œéšæ—¶ä¸ºä½ æä¾›å¸®åŠ©å’Œè§£ç­”é—®é¢˜ï¼æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ"},
          {"role": "user", "content": "æˆ‘åˆšæ‰è¯´çš„å•¥ï¼Ÿ"}
        ],
        "stream": false
      }'
```

å°†ä¹‹å‰çš„èŠå¤©è®°å½•ä¸€å¹¶ç»™ä»–ã€‚



ğŸ¤” å‡è®¾æˆ‘ä»¬ç°åœ¨è¦åšä¸€ä¸ª AI èŠå¤©åº”ç”¨ï¼Œè¿˜æœ‰å“ªäº›é—®é¢˜éœ€è¦è§£å†³ï¼Ÿ

éœ€è¦åšæˆä¸€ä¸ª Web åº”ç”¨

ä¸èƒ½å¯¹ç”¨æˆ·æš´éœ² API key

è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ç‰¹æ€§ï¼šè·å–å®æ—¶ä¿¡æ¯

å­˜å‚¨ä¸Šä¸‹æ–‡



## Agent

è¿™é‡Œä»‹ç»çš„ Agentï¼Œå°±æ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå……å½“ç”¨æˆ·å’Œæ¨¡å‹äº¤æµçš„ä¸­é—´äººã€‚

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-06-051934.png" alt="image-20250706131933681" style="zoom:50%;" />

ä»»ä½•æœåŠ¡å™¨ç«¯è¯­è¨€éƒ½å¯ä»¥å†™

Node.js

**è¯¾å ‚æ¼”ç¤º**

è¯¾ä»¶ã€Š01. èŠå¤©æœºå™¨äººã€‹



æœ‰äº†ä¸­é—´å±‚ï¼Œèƒ½å¤Ÿæ›´å¥½çš„ç®¡ç†ä¸Šä¸‹æ–‡ã€‚

**è¯¾å ‚æ¼”ç¤º**

è¯¾ä»¶ã€Š02. å¸¦ä¸Šä¸‹æ–‡çš„èŠå¤©æœºå™¨äººã€‹



ğŸ¤” è¿™é‡Œçš„ Agent æ˜¯ä¸æ˜¯æ™ºèƒ½ä½“ï¼Œæˆ–è€…è¯´å’Œæ™ºèƒ½ä½“æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

Agent - ä»£ç†æœåŠ¡å™¨ï¼ŒæŠ€æœ¯æ¦‚å¿µ

Agent æ™ºèƒ½ä½“ï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½æ¦‚å¿µï¼Œç›¸å½“äºæ˜¯ç»™ç”¨æˆ· **æ„Ÿå®˜å±‚é¢** çš„ä¸€ä¸ªäº‹ç‰©



## Function Calling

ğŸ¤”å¦‚ä½•èƒ½å¤Ÿè®©æ¨¡å‹è·å–å®æ—¶ä¿¡æ¯å‘¢ï¼Ÿ

å¯ä»¥é‡‡ç”¨è¿™æ ·çš„ä¸€ç§æ–¹æ¡ˆï¼š

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-07-072011.png" alt="image-20250707152011083" style="zoom:50%;" />



é‚£è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå·¥å…·ç®±ä»¥ä»€ä¹ˆæ ·çš„å½¢å¼å‘é€è¿‡å»å‘¢ï¼Ÿ

æ—©æœŸçš„æ—¶å€™ï¼Œå·¥å…·ç®±æ˜¯ä»¥ **æç¤ºè¯** çš„æ–¹å¼å¸¦è¿‡å»çš„ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå› ä¸ºæ¨¡å‹åªèƒ½æ¥æ”¶ä¸€æ®µ **è¾“å…¥**ï¼Œç„¶åè¿”å›ä¸€æ®µ **è¾“å‡º**ã€‚

**è¯¾å ‚æ¼”ç¤º**

è¯¾ä»¶ã€Š03. èŠå¤©æœºå™¨äººè·å–å®æ—¶ä¿¡æ¯ã€‹



ğŸ™‹è¿™ç§æ–¹å¼çš„é—®é¢˜ï¼Ÿ

1. ç¹çï¼šè¿™äº›å¤§é‡çš„æç¤ºè¯ï¼Œä»…ä»…æ˜¯ä¸ºäº†çº¦æŸå¤§æ¨¡å‹çš„è¾“å‡º
2. ä¸æ ‡å‡†
3. çº¦æŸåŠ›ä¸é«˜



OpenAI åœ¨ 2023 å¹´ 6 æœˆæ¨å‡ºäº† Function Callingï¼Œé€šè¿‡ JSON Schema æ ¼å¼æ¥è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä¸»è¦æ ‡å‡†ä¸¤ä¸ªéƒ¨åˆ†ï¼š

1. å·¥å…·ç®±çš„æä¾›

   ```js
   // å·¥å…·ç®±
   const tools = [{
       type: "function",
       name: "get_weather",
       description: "Get current temperature for provided coordinates in celsius.",
       parameters: {
           type: "object",
           properties: {
               latitude: { type: "number" },
               longitude: { type: "number" }
           },
           required: ["latitude", "longitude"],
           additionalProperties: false
       },
       strict: true
   }];
   ```
   
2. è¿”å›çš„è°ƒç”¨å·¥å…·è¯·æ±‚

   ```js
   [{
       "type": "function_call",
       "id": "fc_12345xyz",
       "call_id": "call_12345xyz",
       "name": "get_weather",
       "arguments": "{\"latitude\":48.8566,\"longitude\":2.3522}"
   }]
   ```

å¯ä»¥åœ¨ [OpenAI å®˜æ–¹æ–‡æ¡£](https://platform.openai.com/docs/guides/function-calling?api-mode=responses&lang=javascript#function-calling-steps) çœ‹åˆ°è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥åœ¨ [Playground](https://platform.openai.com/playground/prompts?models=gpt-4.1) è¿™é‡Œä½“éªŒæ•´ä¸ªè¿‡ç¨‹ã€‚

ğŸ¤” ä¸ºä»€ä¹ˆé‡‡ç”¨ Function Calling èƒ½çº¦æŸå¤§æ¨¡å‹ï¼Œè®©å®ƒè¦**ä¸€å®š**æŒ‰ç…§è¦æ±‚è¾“å‡ºä¸€ä¸ª JSON ï¼Ÿ



**è¯¾å ‚æ¼”ç¤º**

è¯¾ä»¶ã€Š04. FunctionCallingç‰ˆæœ¬èŠå¤©æœºå™¨äººã€‹



Function Calling çš„å‡ºç°ï¼Œè§£å†³äº†å‰é¢æ‰€è¯´çš„ä¸‰ä¸ªé—®é¢˜ï¼š

1. æç¤ºè¯ç¹ç
2. æç¤ºè¯æè¿°ä¸æ ‡å‡†
3. æ¨¡å‹è¾“å‡ºä¸å¯æ§



å‡è®¾ç°åœ¨è¦åšä¸€ä¸ªæŸ¥è¯¢å¤©æ°”çš„å…¬å…±å·¥å…·ï¼Œæä¾›ç»™ä¼—å¤šçš„ Agent ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾ï¼š

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-08-063245.png" alt="image-20250708143245500" style="zoom:45%;" />

æœ‰ä¸€ä¸ªéå¸¸æ£˜æ‰‹çš„é—®é¢˜ï¼Œä¸åŒæ¨¡å‹ï¼Œæ³¨å†Œåˆ° Agent é‡Œé¢çš„ Function Calling çš„ JSON æ ¼å¼æ˜¯ä¸ä¸€è‡´çš„ã€‚

deepseek

```js
tools = [{
  "type": "function",
  "function": {
      "name": "get_weather",
      "description": "Get weather of an location",
      "parameters": {
          "type": "object",
          "properties": {
              "location": {
                  "type": "string",
                  "description": "The city and state, e.g. San Francisco, CA",
              }
          },
          "required": ["location"]
      },
  }
}]
```

GPT

```js
const tools = [{
    type: "function",
    name: "get_weather",
    description: "Get current temperature for provided coordinates in celsius.",
    parameters: {
        type: "object",
        properties: {
            latitude: { type: "number" },
            longitude: { type: "number" }
        },
        required: ["latitude", "longitude"],
        additionalProperties: false
    },
    strict: true
}];
```

claude

```js
"tools": [{
  "name": "get_weather",
  "description": "Get the current weather in a given location",
  "input_schema": {
    "type": "object",
    "properties": {
      "location": {
        "type": "string",
        "description": "The city and state, e.g. San Francisco, CA"
      }
    },
    "required": ["location"]
  }
}],
```

ä½œä¸ºå…¬å…±å·¥å…·å¼€å‘è€…ï¼Œä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š

 <img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-08-064123.png" alt="image-20250708144123440" style="zoom:50%;" />

**ä¸åŒçš„æ¨¡å‹ï¼Œå°±æ„å‘³ç€åœ¨ Agent ä¸­æ³¨å†Œå·¥å…·çš„ JSON Schema æ˜¯ä¸åŒçš„**ã€‚

ğŸ¤” å¦‚æœæ˜¯ä½ ï¼Œä½ ä¼šæ€ä¹ˆåŠå‘¢ï¼Ÿ

æœ‰äº›äººå¯èƒ½ä¼šè¯´ï¼Œé‚£æˆ‘å°±å¼€å‘å¤šä¸ªé€‚é…ä¸åŒç‰ˆæœ¬çš„åº“ï¼Œä¾‹å¦‚ï¼š

- å¤©æ°”æŸ¥è¯¢ deepseek ç‰ˆ
- å¤©æ°”æŸ¥è¯¢ gpt ç‰ˆ
- å¤©æ°”æŸ¥è¯¢ claude ç‰ˆ
- ......

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-08-065326.png" alt="image-20250708145326895" style="zoom:50%;" />

è¿™ç§æ–¹æ¡ˆï¼Œå€’ä¹Ÿä¸æ˜¯è¯´ä¸è¡Œã€‚

ä½†æ˜¯ä¸€æ—¦æœªæ¥å‡ºç°äº†æ–°çš„æ¨¡å‹ï¼Œæ„å‘³ç€ä½ è¿™è¾¹å°±å¾—å¼€å‘ä¸€ä¸ªé€‚é…æ–°æ¨¡å‹çš„å¤©æ°”æŸ¥è¯¢å·¥å…·ã€‚

ä¹…è€Œä¹…ä¹‹ï¼Œä½ è‡ªå·±ä¹Ÿç»´æŠ¤ä¸è¿‡æ¥ã€‚

ğŸ¤”è¿™ä¸€åˆ‡çš„ä¸€åˆ‡ï¼Œæ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„ï¼Ÿ

æ ‡å‡†



## MCP

MCP å…¨ç§°ä¸º Model Context Protocolï¼Œâ€œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®â€ã€‚

ä½†å…¶å® **MCP å’Œæ¨¡å‹é—´æ²¡ä»€ä¹ˆå…³ç³»**ï¼Œè€Œæ˜¯æè¿° **Agent** å’Œ **å¤–éƒ¨å·¥å…·** çš„é€šä¿¡åè®®ã€‚

MCP çš„æœ¬è´¨ï¼Œå°±æ˜¯åšäº†ä¸€å±‚æŠ½è±¡ã€‚

ç»™å¤–éƒ¨å·¥å…·å¥—ä¸Šä¸€å±‚ï¼Œè¿™å°±æ˜¯ MCP Serverï¼Œåœ¨ Agent å†…éƒ¨ä¹ŸæŠ½è±¡å‡ºä¸€å±‚ï¼Œè¿™å°±æ˜¯ MCP Client.

![image-20250708145513177](https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-08-065513.png)

æœ‰äº†è¿™ä¸€å±‚ä¸­é—´å±‚ä¹‹åï¼Œå¼€å‘å·¥å…·çš„äººå°±èˆ’æœå¤šäº†ï¼Œåªéœ€è¦å¯¹æ¥ MCP æ ‡å‡†æ ¼å¼å»å¼€å‘å·¥å…·åº”ç”¨ï¼Œæ ¹æœ¬ä¸éœ€è¦å…³å¿ƒèƒŒåæ˜¯ä»€ä¹ˆå¤§æ¨¡å‹ã€‚

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2025-07-07-213413.png" alt="image-20250708053412714" style="zoom:50%;" />

è‡³äºä¸åŒæ¨¡å‹å¯¹åº”çš„ä¸åŒ Function Calling çš„ JSON æ ¼å¼è½¬æ¢å·¥ä½œï¼Œäº¤ç»™ Agent æ¥å¤„ç†ã€‚



1. JSON-RPC
2. é€šä¿¡æœºåˆ¶



### JSON-RPC

å…¨ç§° JSON Remote Procedure Callï¼Œä¸­æ–‡æ˜¯â€œJSON è¿œç¨‹å‡½æ•°è°ƒç”¨â€ã€‚

**RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰** æ˜¯ä¸€ç§ **é€šä¿¡åè®®**ï¼Œç”¨äºåœ¨ä¸åŒçš„è¿›ç¨‹ä¹‹é—´è°ƒç”¨å‡½æ•°ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ã€‚å¯ä»¥ç”¨äºï¼š

- åŒä¸€å°æœºå™¨ä¸Šçš„ä¸åŒè¿›ç¨‹ï¼ˆè·¨è¿›ç¨‹é€šä¿¡ï¼‰
- ä¸åŒæœºå™¨ä¹‹é—´ï¼ˆè·¨ç½‘ç»œé€šä¿¡ï¼‰

RPC å®ç°æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š

- gRPCï¼ˆGoogle çš„é«˜æ€§èƒ½ RPCï¼‰
- JSON-RPCï¼ˆæ¯”å¦‚ MCP åè®®å°±åŸºäºè¿™ä¸ªï¼‰
- XML-RPC

MCP åè®®å°±æ˜¯åŸºäº JSON-RPCï¼Œå¯ä»¥éå¸¸è½»æ¾çš„å®ç°å®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨æœåŠ¡ç«¯çš„å‡½æ•°ã€‚MCP ä¸­æ‰€æœ‰é€šä¿¡éƒ½éµå¾ª JSON-RPC 2.0ï¼Œ2.0 ç›¸æ¯” 1.0 åšäº†å„ä¸ªæ–¹é¢çš„ä¼˜åŒ–ï¼š

Requests è¯·æ±‚ï¼ˆåŒå‘å¯å‘ï¼‰

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "callTool",
  "params": { ... }
}
```

- å¿…é¡»åŒ…å« `id`ï¼ˆå”¯ä¸€ï¼‰
- ç”¨äºå‘èµ·åŒå‘äº¤äº’

Responses å“åº”ï¼ˆç”¨äºå›åº”è¯·æ±‚ï¼‰

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": { ... }
}
```

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "error": { "code": 1001, "message": "Tool not found" }
}
```

- å¿…é¡»å“åº”å¯¹åº”è¯·æ±‚ ID
- åªèƒ½å‡ºç° result æˆ– errorï¼ˆäºŒé€‰ä¸€ï¼‰

Notifications é€šçŸ¥ï¼ˆå•å‘ï¼‰

```json
{
  "jsonrpc": "2.0",
  "method": "logEvent",
  "params": { ... }
}
```

- **ä¸èƒ½åŒ…å« ID**ï¼Œå› æ­¤æ¥æ”¶æ–¹ä¸èƒ½å“åº”
- ç”¨äºå•å‘é€šçŸ¥ï¼Œå¦‚ï¼šæ—¥å¿—ã€çŠ¶æ€å˜åŒ–ç­‰



### é€šä¿¡æœºåˆ¶

å®˜æ–¹ç›®å‰æä¾›äº†ä¸¤ç§æ ‡å‡†çš„é€šä¿¡æ–¹å¼ï¼š

**1. stdio æµé€šä¿¡**

stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰ä¼ è¾“æ–¹å¼å…è®¸é€šè¿‡æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰å’Œæ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰è¿›è¡Œé€šä¿¡ã€‚

- é€šå¸¸ç”¨äº MCP Server æ˜¯ä¸€ä¸ªæœ¬åœ° Node.jsã€Pythonã€Rust ç­‰è„šæœ¬
- MCP Client ä»¥å­è¿›ç¨‹æ–¹å¼å¯åŠ¨ Serverï¼Œå¹¶é€šè¿‡ stdin/stdout ä¸å®ƒé€šä¿¡ï¼ˆæ— éœ€ HTTPï¼‰

```js
node xxx.js
```

```js
// ç°åœ¨æ˜¯åœ¨ MCP Client é‡Œé¢
import { spawn } from "child_process";
spawn(...); 
```



ä»¥ä¸‹åœºæ™¯æ¨èä½¿ç”¨ stdioï¼š

1. æ„å»ºå‘½ä»¤è¡Œå·¥å…·æ—¶
2. å®ç°æœ¬åœ°ç³»ç»Ÿé›†æˆæ—¶ï¼ˆå¦‚ä¸æœ¬æœºè½¯ä»¶äº¤äº’ï¼‰
3. éœ€è¦è¿›ç¨‹ä¹‹é—´çš„ç®€å•é€šä¿¡æ—¶ï¼ˆå¦‚å­è¿›ç¨‹ï¼‰



**2. Streamable HTTP**

Streamable HTTP æ˜¯ä¸€ç§ä¼ è¾“æœºåˆ¶ï¼Œè¿™ç§æ–¹å¼æ˜¯åŸºäº HTTP åè®®ï¼š

- è¯·æ±‚ - ä½¿ç”¨ POST è¯·æ±‚å°†å®¢æˆ·ç«¯æ¶ˆæ¯å‘é€ç»™æœåŠ¡å™¨
- å“åº” - æ”¯æŒä¸¤ç§å½¢å¼ï¼š
  - æ™®é€š JSON å“åº”ï¼šé€‚ç”¨äºç®€å•è¿”å›ç»“æœ
  - SSE æµå¼å“åº”ï¼šç”¨äºéœ€è¦å¤šæ¬¡åˆ†æ®µæ¨é€å†…å®¹çš„åœºæ™¯ï¼ˆå¦‚ç”Ÿæˆæµï¼‰

è¿™æ˜¯ MCP åè®®æ¨èçš„æ–°ä¸€ä»£é€šä¿¡æ–¹å¼ï¼Œç”¨ HTTP åŒå‘ä¼ é€’æ¶ˆæ¯ï¼Œå…¼é¡¾å…¼å®¹æ€§ä¸æµå¼èƒ½åŠ›

ä»¥ä¸‹åœºæ™¯æ¨èä½¿ç”¨ Streamable HTTPï¼š

- å¼€å‘åŸºäº Web çš„é›†æˆæœåŠ¡æ—¶ï¼ˆå¦‚ SaaS å·¥å…·ã€ç½‘é¡µåº”ç”¨ï¼‰
- éœ€è¦ä½¿ç”¨ HTTP å®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´é€šä¿¡æ—¶
- éœ€è¦ç»´æŠ¤çŠ¶æ€ä¼šè¯æ—¶ï¼ˆstateful sessionï¼Œæ¯”å¦‚å¯¹è¯ä¸Šä¸‹æ–‡ï¼‰
- éœ€è¦æ”¯æŒå¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘è¿æ¥æ—¶
- éœ€è¦æ”¯æŒå¯æ¢å¤è¿æ¥ï¼ˆresumable connectionï¼‰æ—¶



### MCP Server

ç›®å‰å®˜æ–¹ç»„ç»‡æ¨å‡ºäº†ä¸€äº› [MCP Server](https://github.com/modelcontextprotocol/servers)

é™¤äº†å®˜æ–¹ä»¥å¤–ï¼Œä¹Ÿæœ‰ä¸€äº›ç¬¬ä¸‰æ–¹çš„ MCP Server çš„å¹³å°ï¼Œä¾‹å¦‚ï¼š

1. [MCP.So](https://mcp.so/)
2. [Awesome MCP Servers](https://mcpservers.org/)

>[!tip]
>
>ä¸è¿‡ç›®å‰ç¬¬ä¸‰æ–¹å¹³å°çš„ MCP Server çš„è´¨é‡å‚å·®ä¸é½ï¼Œæ¨èä¼˜å…ˆä½¿ç”¨å®˜æ–¹æ¨å‡ºçš„ MCP Serverã€‚

**è¯¾å ‚ç»ƒä¹ **

å®ç°å¤©æ°”æŸ¥è¯¢çš„ MCP Server



### MCP Client

**è¯¾å ‚ç»ƒä¹ **

å®ç°MCP Client



## ä¾èµ–å®¡è®¡

å‰ç½®çŸ¥è¯†ï¼š

1. npm-registry-fetch
2. zod
3. CVEç¼–å·ä¸ CVSS åˆ†æ•°



**CVE ç¼–å·ï¼ˆCommon Vulnerabilities and Exposuresï¼‰**

- æ˜¯å…¨çƒé€šç”¨çš„å®‰å…¨æ¼æ´ç¼–å·ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼š`CVE-2024-12345`
- æ¯ä¸€ä¸ªå·²çŸ¥çš„å®‰å…¨æ¼æ´ï¼ˆæ¯”å¦‚æŸä¸ª npm åŒ…çš„æ¼æ´ï¼‰éƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ CVE ç¼–å·ï¼Œä¾¿äºåœ¨å®‰å…¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ã€‚
- ä½ å¯ä»¥åœ¨ [è¿™é‡Œ](https://github.com/advisories) çœ‹åˆ°å®‰å…¨æ¼æ´çš„æè¿°ä»¥åŠ CVE ç¼–å·ã€‚



**CVSS åˆ†æ•°ï¼ˆCommon Vulnerability Scoring Systemï¼‰**

- æ˜¯å¯¹æ¼æ´â€œå±é™©ç¨‹åº¦â€çš„ä¸€ä¸ªè¯„åˆ†ç³»ç»Ÿï¼Œåˆ†æ•°ä» 0 åˆ° 10ï¼š
  - 0.0ï¼šæ— é£é™©
  - 4.0~6.9ï¼šä¸­ç­‰
  - 7.0~8.9ï¼šé«˜å±
  - 9.0~10.0ï¼šä¸¥é‡
- å¼€å‘è€…å¯ä»¥ç”¨è¿™ä¸ªåˆ†æ•°åˆ¤æ–­æ¼æ´æ˜¯å¦å€¼å¾—ç«‹å³ä¿®å¤ã€‚

---

-EOF-
